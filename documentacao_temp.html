<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DocumentaÃ§Ã£o Estrutura KlubeCash</title>
    <style>
        body {
            font-family: "Times New Roman", serif;
            line-height: 1.6;
            margin: 20mm;
            color: #333;
            font-size: 12pt;
        }
        h1 {
            color: #FF7A00;
            border-bottom: 3px solid #FF7A00;
            padding-bottom: 10px;
            margin-top: 30px;
            font-size: 24pt;
        }
        h2 {
            color: #333;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
            margin-top: 25px;
            font-size: 18pt;
        }
        h3 {
            color: #555;
            margin-top: 20px;
            font-size: 14pt;
        }
        h4 {
            color: #666;
            margin-top: 15px;
            font-size: 12pt;
        }
        pre {
            background: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            overflow-x: auto;
            font-family: "Courier New", monospace;
            font-size: 10pt;
            line-height: 1.4;
        }
        code {
            background: #f0f0f0;
            padding: 2px 4px;
            border-radius: 3px;
            font-family: "Courier New", monospace;
            font-size: 10pt;
        }
        pre code {
            background: none;
            padding: 0;
        }
        ul, ol {
            margin: 10px 0;
            padding-left: 30px;
        }
        li {
            margin: 5px 0;
        }
        p {
            margin: 10px 0;
            text-align: justify;
        }
        strong {
            font-weight: bold;
            color: #333;
        }
        .page-break {
            page-break-before: always;
        }
        .toc {
            border: 1px solid #ddd;
            background: #f9f9f9;
            padding: 20px;
            margin: 20px 0;
        }
        .directory-tree {
            font-family: "Courier New", monospace;
            background: #f8f8f8;
            border: 1px solid #ddd;
            padding: 15px;
            line-height: 1.3;
            font-size: 10pt;
        }
        .architecture-diagram {
            text-align: center;
            margin: 20px 0;
            font-family: monospace;
            background: #f5f5f5;
            padding: 15px;
            border: 1px solid #ddd;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f5f5f5;
            font-weight: bold;
        }
        @media print {
            body { margin: 0; }
            .page-break { page-break-before: always; }
        }
    </style>
</head>
<body>
<h1>DocumentaÃ§Ã£o da Estrutura do Projeto KlubeCash</h1><p><h2>Ãndice</h2>
<li><a href="#visÃ£o-geral">VisÃ£o Geral</a></li>
<li><a href="#arquitetura-do-sistema">Arquitetura do Sistema</a></li>
<li><a href="#estrutura-de-diretÃ³rios">Estrutura de DiretÃ³rios</a></li>
<li><a href="#padrÃµes-arquiteturais">PadrÃµes Arquiteturais</a></li>
<li><a href="#componentes-principais">Componentes Principais</a></li>
<li><a href="#banco-de-dados">Banco de Dados</a></li>
<li><a href="#apis-e-integraÃ§Ãµes">APIs e IntegraÃ§Ãµes</a></li>
<li><a href="#seguranÃ§a">SeguranÃ§a</a></li>
<li><a href="#frontend-e-ui">Frontend e UI</a></li>
<li><a href="#mobile-flutter">Mobile (Flutter)</a></li>
<li><a href="#como-replicar-em-outros-projetos">Como Replicar em Outros Projetos</a></li></p><p>---</p><h2>VisÃ£o Geral</h2><p>O <strong>KlubeCash</strong> Ã© um sistema completo de cashback desenvolvido em PHP com arquitetura MVC (Model-View-Controller). O sistema permite que clientes ganhem dinheiro de volta em compras, lojas gerenciem transaÃ§Ãµes e administradores controlem todo o ecossistema.</p><p><h3>CaracterÃ­sticas Principais:</h3>
<ul><li>Sistema multi-usuÃ¡rio (Clientes, Lojas, FuncionÃ¡rios, Administradores)</li>
<li>IntegraÃ§Ã£o com Mercado Pago e OpenPix</li>
<li>PWA (Progressive Web App) com funcionalidades offline</li>
<li>Aplicativo mobile em Flutter</li>
<li>Sistema de notificaÃ§Ãµes via WhatsApp</li>
<li>Dashboard administrativo completo</li></p><p>---</p><h2>Arquitetura do Sistema</h2><p><h3>PadrÃ£o MVC HÃ­brido</h3>
O sistema utiliza uma abordagem MVC adaptada:</p><pre><code class="language-">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Views    â”‚â—„â”€â”€â–ºâ”‚ Controllers â”‚â—„â”€â”€â–ºâ”‚   Models    â”‚
â”‚ (Frontend)  â”‚    â”‚  (LÃ³gica)   â”‚    â”‚ (Dados)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚                   â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Database   â”‚
                    â”‚   (MySQL)   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre><p><h3>Fluxo de Dados:</h3>
<li><strong>Entrada</strong>: UsuÃ¡rio interage com Views (PHP/HTML/CSS/JS)</li>
<li><strong>Processamento</strong>: Controllers processam requisiÃ§Ãµes</li>
<li><strong>Dados</strong>: Models interagem com o banco de dados</li>
<li><strong>SaÃ­da</strong>: Resposta retorna via Views ou APIs JSON</li></p><p>---</p><h2>Estrutura de DiretÃ³rios</h2><pre><code class="language-">klubecash/
â”œâ”€â”€ ğŸ“ api/                          # APIs principais do sistema
â”‚   â”œâ”€â”€ balance.php                  # API de saldo
â”‚   â”œâ”€â”€ mercadopago.php             # IntegraÃ§Ã£o Mercado Pago
â”‚   â”œâ”€â”€ openpix.php                 # IntegraÃ§Ã£o OpenPix
â”‚   â”œâ”€â”€ transactions.php            # API de transaÃ§Ãµes
â”‚   â””â”€â”€ users.php                   # API de usuÃ¡rios
â”‚
â”œâ”€â”€ ğŸ“ api2/                         # APIs secundÃ¡rias/auxiliares
â”‚   â”œâ”€â”€ login.php                   # API de autenticaÃ§Ã£o
â”‚   â”œâ”€â”€ profile/                    # APIs de perfil
â”‚   â””â”€â”€ notifications.php           # API de notificaÃ§Ãµes
â”‚
â”œâ”€â”€ ğŸ“ assets/                       # Recursos estÃ¡ticos
â”‚   â”œâ”€â”€ css/                        # Folhas de estilo
â”‚   â”‚   â”œâ”€â”€ components/             # CSS de componentes
â”‚   â”‚   â””â”€â”€ views/                  # CSS especÃ­fico por view
â”‚   â”œâ”€â”€ js/                         # JavaScript
â”‚   â”‚   â”œâ”€â”€ components/             # JS de componentes
â”‚   â”‚   â””â”€â”€ admin/                  # JS administrativo
â”‚   â”œâ”€â”€ images/                     # Imagens do sistema
â”‚   â””â”€â”€ icons/                      # Ãcones PWA
â”‚
â”œâ”€â”€ ğŸ“ auth/                         # Sistema de autenticaÃ§Ã£o
â”‚   â””â”€â”€ google/                     # AutenticaÃ§Ã£o Google OAuth
â”‚
â”œâ”€â”€ ğŸ“ classes/                      # Classes utilitÃ¡rias
â”‚   â”œâ”€â”€ CashbackNotifier.php        # NotificaÃ§Ãµes de cashback
â”‚   â”œâ”€â”€ ImageGenerator.php          # GeraÃ§Ã£o de imagens
â”‚   â””â”€â”€ SaldoConsulta.php          # Consulta de saldos
â”‚
â”œâ”€â”€ ğŸ“ config/                       # ConfiguraÃ§Ãµes do sistema
â”‚   â”œâ”€â”€ constants.php               # Constantes globais
â”‚   â”œâ”€â”€ database.php                # ConfiguraÃ§Ã£o do BD
â”‚   â””â”€â”€ email.php                   # ConfiguraÃ§Ã£o de email
â”‚
â”œâ”€â”€ ğŸ“ controllers/                  # Controladores MVC
â”‚   â”œâ”€â”€ AdminController.php         # Controle administrativo
â”‚   â”œâ”€â”€ AuthController.php          # Controle de autenticaÃ§Ã£o
â”‚   â”œâ”€â”€ ClientController.php        # Controle de clientes
â”‚   â”œâ”€â”€ StoreController.php         # Controle de lojas
â”‚   â””â”€â”€ TransactionController.php   # Controle de transaÃ§Ãµes
â”‚
â”œâ”€â”€ ğŸ“ core/                         # NÃºcleo do sistema
â”‚   â””â”€â”€ bootstrap.php               # InicializaÃ§Ã£o do sistema
â”‚
â”œâ”€â”€ ğŸ“ cron/                         # Tarefas agendadas
â”‚   â”œâ”€â”€ send-scheduled-emails.php   # Envio de emails
â”‚   â””â”€â”€ send-weekly-emails.php      # RelatÃ³rios semanais
â”‚
â”œâ”€â”€ ğŸ“ libs/                         # Bibliotecas externas
â”‚   â””â”€â”€ PHPMailer/                  # Biblioteca de email
â”‚
â”œâ”€â”€ ğŸ“ models/                       # Modelos de dados
â”‚   â”œâ”€â”€ User.php                    # Modelo de usuÃ¡rio
â”‚   â”œâ”€â”€ Store.php                   # Modelo de loja
â”‚   â”œâ”€â”€ Transaction.php             # Modelo de transaÃ§Ã£o
â”‚   â””â”€â”€ Payment.php                 # Modelo de pagamento
â”‚
â”œâ”€â”€ ğŸ“ pwa/                          # Progressive Web App
â”‚   â”œâ”€â”€ manifest.json               # Manifesto PWA
â”‚   â”œâ”€â”€ sw.js                       # Service Worker
â”‚   â””â”€â”€ offline.html                # PÃ¡gina offline
â”‚
â”œâ”€â”€ ğŸ“ utils/                        # UtilitÃ¡rios do sistema
â”‚   â”œâ”€â”€ Email.php                   # UtilitÃ¡rios de email
â”‚   â”œâ”€â”€ Security.php                # SeguranÃ§a
â”‚   â”œâ”€â”€ Validator.php               # ValidaÃ§Ãµes
â”‚   â”œâ”€â”€ PaymentProcessor.php        # Processamento de pagamentos
â”‚   â””â”€â”€ WhatsAppBot.php             # Bot do WhatsApp
â”‚
â”œâ”€â”€ ğŸ“ views/                        # Camada de apresentaÃ§Ã£o
â”‚   â”œâ”€â”€ admin/                      # Painel administrativo
â”‚   â”œâ”€â”€ client/                     # Ãrea do cliente
â”‚   â”œâ”€â”€ stores/                     # Ãrea das lojas
â”‚   â”œâ”€â”€ auth/                       # PÃ¡ginas de autenticaÃ§Ã£o
â”‚   â””â”€â”€ components/                 # Componentes reutilizÃ¡veis
â”‚
â”œâ”€â”€ ğŸ“ klubecashmobile/              # Aplicativo Flutter
â”‚   â”œâ”€â”€ lib/                        # CÃ³digo fonte Dart
â”‚   â”‚   â”œâ”€â”€ features/               # Features por domÃ­nio
â”‚   â”‚   â”œâ”€â”€ core/                   # NÃºcleo da aplicaÃ§Ã£o
â”‚   â”‚   â””â”€â”€ main.dart               # Ponto de entrada
â”‚   â”œâ”€â”€ android/                    # ConfiguraÃ§Ãµes Android
â”‚   â””â”€â”€ ios/                        # ConfiguraÃ§Ãµes iOS
â”‚
â”œâ”€â”€ ğŸ“ whatsapp/                     # Bot WhatsApp (Node.js)
â”‚   â”œâ”€â”€ bot.js                      # LÃ³gica do bot
â”‚   â”œâ”€â”€ package.json                # DependÃªncias Node.js
â”‚   â””â”€â”€ start.sh                    # Script de inicializaÃ§Ã£o
â”‚
â””â”€â”€ index.php                       # PÃ¡gina principal</code></pre><p>---</p><h2>PadrÃµes Arquiteturais</h2><p><h3>1. <strong>MVC (Model-View-Controller)</strong></h3>
<pre><code class="language-php">// Exemplo de Controller
class AuthController {
    public static function login($email, $senha) {
        // ValidaÃ§Ã£o de entrada
        $validator = new Validator();
        
        // InteraÃ§Ã£o com Model
        $user = new User();
        $result = $user->authenticate($email, $senha);
        
        // Retorno para View
        return $result;
    }
}</code></pre></p><p><h3>2. <strong>Singleton Pattern</strong> (ConexÃ£o com BD)</h3>
<pre><code class="language-php">class Database {
    private static $connection = null;
    
    public static function getConnection() {
        if (self::$connection === null) {
            // Criar nova conexÃ£o
            self::$connection = new PDO($dsn, $user, $pass);
        }
        return self::$connection;
    }
}</code></pre></p><p><h3>3. <strong>Factory Pattern</strong> (Para criaÃ§Ã£o de objetos)</h3>
<pre><code class="language-php">class UserFactory {
    public static function create($type) {
        switch($type) {
            case 'cliente': return new Cliente();
            case 'loja': return new Loja();
            case 'admin': return new Administrador();
        }
    }
}</code></pre></p><p><h3>4. <strong>Repository Pattern</strong> (Acesso a dados)</h3>
<pre><code class="language-php">class UserRepository {
    public function findById($id) {
        // LÃ³gica de busca no BD
    }
    
    public function save($user) {
        // LÃ³gica de salvamento
    }
}</code></pre></p><p>---</p><h2>Componentes Principais</h2><p><h3>1. <strong>Sistema de AutenticaÃ§Ã£o</strong></h3>
<li><strong>LocalizaÃ§Ã£o</strong>: <code>controllers/AuthController.php</code></li>
<li><strong>Responsabilidades</strong>:</li>
  - Login/logout de usuÃ¡rios
  - Registro de novos usuÃ¡rios
  - RecuperaÃ§Ã£o de senha
  - GestÃ£o de sessÃµes
  - AutenticaÃ§Ã£o Google OAuth</p><pre><code class="language-php">// Exemplo de uso
$result = AuthController::login($email, $senha);
if ($result['status']) {
    // UsuÃ¡rio autenticado
    header('Location: /dashboard');
}</code></pre><p><h3>2. <strong>Sistema de Cashback</strong></h3>
<li><strong>LocalizaÃ§Ã£o</strong>: <code>classes/CashbackNotifier.php</code></li>
<li><strong>Responsabilidades</strong>:</li>
  - CÃ¡lculo de cashback
  - NotificaÃ§Ãµes automÃ¡ticas
  - Processamento de transaÃ§Ãµes</p><p><h3>3. <strong>Sistema de Pagamentos</strong></h3>
<li><strong>LocalizaÃ§Ã£o</strong>: <code>utils/PaymentProcessor.php</code></li>
<li><strong>IntegraÃ§Ãµes</strong>:</li>
  - Mercado Pago (PIX, cartÃ£o)
  - OpenPix (PIX)
  - Webhooks para confirmaÃ§Ã£o</p><p><h3>4. <strong>Sistema de NotificaÃ§Ãµes</strong></h3>
<li><strong>WhatsApp</strong>: <code>whatsapp/bot.js</code></li>
<li><strong>Push Notifications</strong>: PWA</li>
<li><strong>Email</strong>: <code>utils/Email.php</code></li></p><p>---</p><h2>Banco de Dados</h2><h3>Estrutura Principal:</h3><pre><code class="language-sql">-- UsuÃ¡rios do sistema
CREATE TABLE usuarios (
    id INT PRIMARY KEY AUTO_INCREMENT,
    nome VARCHAR(255) NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    senha_hash VARCHAR(255) NOT NULL,
    tipo ENUM('cliente', 'loja', 'admin', 'funcionario'),
    status ENUM('ativo', 'inativo', 'bloqueado'),
    data_criacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);</p><p>-- Lojas parceiras
CREATE TABLE lojas (
    id INT PRIMARY KEY AUTO_INCREMENT,
    usuario_id INT,
    nome_fantasia VARCHAR(255) NOT NULL,
    categoria VARCHAR(100),
    porcentagem_cashback DECIMAL(5,2),
    status ENUM('pendente', 'aprovado', 'rejeitado'),
    FOREIGN KEY (usuario_id) REFERENCES usuarios(id)
);</p><p>-- TransaÃ§Ãµes de cashback
CREATE TABLE transacoes (
    id INT PRIMARY KEY AUTO_INCREMENT,
    cliente_id INT,
    loja_id INT,
    valor_compra DECIMAL(10,2),
    valor_cashback DECIMAL(10,2),
    status ENUM('pendente', 'aprovado', 'cancelado'),
    data_transacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (cliente_id) REFERENCES usuarios(id),
    FOREIGN KEY (loja_id) REFERENCES lojas(id)
);</code></pre><p><h3>PadrÃµes de Uso:</h3>
<li><strong>Prepared Statements</strong> para seguranÃ§a</li>
<li><strong>TransaÃ§Ãµes</strong> para operaÃ§Ãµes complexas</li>
<li><strong>Ãndices</strong> para performance</li>
<li><strong>Foreign Keys</strong> para integridade</li></p><p>---</p><h2>APIs e IntegraÃ§Ãµes</h2><h3>1. <strong>APIs REST Internas</strong></h3><p><h4>Estrutura PadrÃ£o:</h4>
<pre><code class="language-php">// api/exemplo.php
header('Content-Type: application/json');</p><p>try {
    // ValidaÃ§Ã£o de entrada
    $input = json_decode(file_get_contents('php://input'), true);
    
    // Processamento
    $result = processarRequisicao($input);
    
    // Resposta
    echo json_encode([
        'success' => true,
        'data' => $result
    ]);
} catch (Exception $e) {
    echo json_encode([
        'success' => false,
        'error' => $e->getMessage()
    ]);
}</code></pre></p><p><h3>2. <strong>IntegraÃ§Ã£o Mercado Pago</strong></h3>
<pre><code class="language-php">// utils/MercadoPagoClient.php
class MercadoPagoClient {
    private $accessToken = MP_ACCESS_TOKEN;
    
    public function createPayment($data) {
        $curl = curl_init();
        curl_setopt_array($curl, [
            CURLOPT_URL => MP_BASE_URL . '/v1/payments',
            CURLOPT_POST => true,
            CURLOPT_POSTFIELDS => json_encode($data),
            CURLOPT_HTTPHEADER => [
                'Authorization: Bearer ' . $this->accessToken,
                'Content-Type: application/json'
            ]
        ]);
        
        return json_decode(curl_exec($curl), true);
    }
}</code></pre></p><p><h3>3. <strong>Sistema de Webhooks</strong></h3>
<pre><code class="language-php">// webhook/openpix.php
$payload = file_get_contents('php://input');
$signature = $_SERVER['HTTP_X_WEBHOOK_SIGNATURE'] ?? '';</p><p>if (Security::validateWebhook($payload, $signature)) {
    $data = json_decode($payload, true);
    PaymentProcessor::processWebhook($data);
}</code></pre></p><p>---</p><h2>SeguranÃ§a</h2><p><h3>1. <strong>ProteÃ§Ã£o CSRF</strong></h3>
<pre><code class="language-php">// utils/Security.php
class Security {
    public static function generateCSRFToken() {
        return bin2hex(random_bytes(32));
    }
    
    public static function validateCSRFToken($token) {
        return hash_equals($_SESSION['csrf_token'], $token);
    }
}</code></pre></p><p><h3>2. <strong>SanitizaÃ§Ã£o de Dados</strong></h3>
<pre><code class="language-php">public static function sanitizeInput($data) {
    return htmlspecialchars(strip_tags(trim($data)));
}</code></pre></p><p><h3>3. <strong>ValidaÃ§Ã£o de PermissÃµes</strong></h3>
<pre><code class="language-php">public static function requireAdminAccess() {
    if (!isset($_SESSION['user_type']) || $_SESSION['user_type'] !== 'admin') {
        header('Location: /acesso-negado');
        exit;
    }
}</code></pre></p><p><h3>4. <strong>ConfiguraÃ§Ãµes de SessÃ£o Segura</strong></h3>
<pre><code class="language-php">// config/constants.php
ini_set('session.cookie_httponly', 1);
ini_set('session.cookie_secure', 1);
ini_set('session.cookie_samesite', 'Strict');</code></pre></p><p>---</p><h2>Frontend e UI</h2><p><h3>1. <strong>Arquitetura CSS</strong></h3>
<pre><code class="language-">assets/css/
â”œâ”€â”€ mobile-first.css        # Base responsiva
â”œâ”€â”€ components/            # Componentes UI
â”‚   â”œâ”€â”€ toast.css         # NotificaÃ§Ãµes
â”‚   â””â”€â”€ sidebar.css       # NavegaÃ§Ã£o
â””â”€â”€ views/                # Estilos por pÃ¡gina
    â”œâ”€â”€ admin/
    â”œâ”€â”€ client/
    â””â”€â”€ stores/</code></pre></p><p><h3>2. <strong>JavaScript Modular</strong></h3>
<pre><code class="language-javascript">// assets/js/components/toast.js
class Toast {
    static show(message, type = 'info') {
        const toast = document.createElement('div');
        toast.className = <code>toast toast-${type}</code>;
        toast.textContent = message;
        document.body.appendChild(toast);
    }
}</code></pre></p><p><h3>3. <strong>PWA (Progressive Web App)</strong></h3>
<pre><code class="language-javascript">// pwa/sw.js - Service Worker
self.addEventListener('install', event => {
    event.waitUntil(
        caches.open('klube-cash-v1').then(cache => {
            return cache.addAll([
                '/',
                '/cliente/dashboard',
                '/assets/css/main.css',
                '/assets/js/main.js'
            ]);
        })
    );
});</code></pre></p><p><h3>4. <strong>Componentes ReutilizÃ¡veis</strong></h3>
<pre><code class="language-php">// views/components/sidebar.php
function renderSidebar($activeMenu, $userType) {
    $menuItems = getMenuItemsByUserType($userType);
    include 'sidebar-template.php';
}</code></pre></p><p>---</p><h2>Mobile (Flutter)</h2><h3>Arquitetura Clean Architecture</h3><pre><code class="language-">lib/
â”œâ”€â”€ core/                  # NÃºcleo da aplicaÃ§Ã£o
â”‚   â”œâ”€â”€ constants/        # Constantes
â”‚   â”œâ”€â”€ network/          # Cliente HTTP
â”‚   â”œâ”€â”€ utils/            # UtilitÃ¡rios
â”‚   â””â”€â”€ widgets/          # Widgets base
â”‚
â”œâ”€â”€ features/             # Features por domÃ­nio
â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”œâ”€â”€ data/         # Fontes de dados
â”‚   â”‚   â”œâ”€â”€ domain/       # Regras de negÃ³cio
â”‚   â”‚   â””â”€â”€ presentation/ # UI e Estado
â”‚   â”œâ”€â”€ dashboard/
â”‚   â”œâ”€â”€ cashback/
â”‚   â””â”€â”€ stores/
â”‚
â””â”€â”€ main.dart             # Ponto de entrada</code></pre><p><h3>Exemplo de Feature:</h3>
<pre><code class="language-dart">// features/auth/presentation/providers/auth_provider.dart
class AuthProvider extends ChangeNotifier {
  final LoginUseCase _loginUseCase;
  
  Future<void> login(String email, String password) async {
    final result = await _loginUseCase(
      LoginParams(email: email, password: password)
    );
    
    result.fold(
      (failure) => _handleError(failure),
      (user) => _handleSuccess(user),
    );
  }
}</code></pre></p><p>---</p><h2>Como Replicar em Outros Projetos</h2><h3>1. <strong>Estrutura Base Recomendada</strong></h3><pre><code class="language-">projeto/
â”œâ”€â”€ config/              # ConfiguraÃ§Ãµes
â”‚   â”œâ”€â”€ constants.php    # Constantes globais
â”‚   â””â”€â”€ database.php     # ConexÃ£o BD
â”œâ”€â”€ core/                # NÃºcleo
â”‚   â””â”€â”€ bootstrap.php    # InicializaÃ§Ã£o
â”œâ”€â”€ controllers/         # Controladores
â”œâ”€â”€ models/             # Modelos
â”œâ”€â”€ views/              # Views
â”‚   â””â”€â”€ components/     # Componentes
â”œâ”€â”€ utils/              # UtilitÃ¡rios
â”œâ”€â”€ assets/             # Recursos estÃ¡ticos
â””â”€â”€ api/                # APIs</code></pre><h3>2. <strong>PadrÃµes para Adotar</strong></h3><p><h4>A. <strong>ConfiguraÃ§Ã£o Centralizada</strong></h4>
<pre><code class="language-php">// config/constants.php
define('DB_HOST', 'localhost');
define('SITE_URL', 'https://seusite.com');
define('EMAIL_FROM', 'noreply@seusite.com');</code></pre></p><p><h4>B. <strong>Bootstrap de InicializaÃ§Ã£o</strong></h4>
<pre><code class="language-php">// core/bootstrap.php
require_once 'config/constants.php';
require_once 'config/database.php';</p><p>// Autoload de classes
spl_autoload_register(function($class) {
    $paths = ['controllers/', 'models/', 'utils/'];
    foreach($paths as $path) {
        $file = $path . $class . '.php';
        if (file_exists($file)) {
            require_once $file;
            break;
        }
    }
});</code></pre></p><p><h4>C. <strong>Controller Base</strong></h4>
<pre><code class="language-php">// controllers/BaseController.php
abstract class BaseController {
    protected function validateInput($data, $rules) {
        return Validator::validate($data, $rules);
    }
    
    protected function jsonResponse($data, $status = 200) {
        header('Content-Type: application/json');
        http_response_code($status);
        echo json_encode($data);
        exit;
    }
}</code></pre></p><p><h4>D. <strong>Model Base</strong></h4>
<pre><code class="language-php">// models/BaseModel.php
abstract class BaseModel {
    protected $db;
    protected $table;
    
    public function __construct() {
        $this->db = Database::getConnection();
    }
    
    public function findById($id) {
        $stmt = $this->db->prepare("SELECT * FROM {$this->table} WHERE id = ?");
        $stmt->execute([$id]);
        return $stmt->fetch(PDO::FETCH_ASSOC);
    }
}</code></pre></p><h3>3. <strong>ImplementaÃ§Ã£o de SeguranÃ§a</strong></h3><pre><code class="language-php">// utils/Security.php - Adaptar para seu projeto
class Security {
    public static function sanitize($input) {
        if (is_array($input)) {
            return array_map([self::class, 'sanitize'], $input);
        }
        return htmlspecialchars(strip_tags(trim($input)));
    }
    
    public static function validateSession() {
        if (!isset($_SESSION['user_id'])) {
            header('Location: /login');
            exit;
        }
    }
}</code></pre><h3>4. <strong>Sistema de Componentes</strong></h3><pre><code class="language-php">// views/components/layout.php
function renderLayout($title, $content, $sidebar = true) {
    include 'header.php';
    if ($sidebar) include 'sidebar.php';
    echo $content;
    include 'footer.php';
}</code></pre><h3>5. <strong>API Padronizada</strong></h3><pre><code class="language-php">// api/base_api.php
abstract class BaseAPI {
    protected function handleRequest() {
        try {
            $method = $_SERVER['REQUEST_METHOD'];
            $input = json_decode(file_get_contents('php://input'), true);
            
            switch($method) {
                case 'GET': return $this->get();
                case 'POST': return $this->post($input);
                case 'PUT': return $this->put($input);
                case 'DELETE': return $this->delete();
            }
        } catch (Exception $e) {
            $this->errorResponse($e->getMessage());
        }
    }
    
    protected function successResponse($data) {
        echo json_encode(['success' => true, 'data' => $data]);
    }
    
    protected function errorResponse($message) {
        echo json_encode(['success' => false, 'error' => $message]);
    }
}</code></pre><h3>6. <strong>Checklist para ImplementaÃ§Ã£o</strong></h3><p><h4>Essencial:</h4>
<li>[ ] ConfiguraÃ§Ã£o de constantes centralizadas</li>
<li>[ ] Sistema de autoload ou bootstrap</li>
<li>[ ] ConexÃ£o segura com banco de dados</li>
<li>[ ] ValidaÃ§Ã£o e sanitizaÃ§Ã£o de entrada</li>
<li>[ ] Sistema de sessÃµes seguro</li>
<li>[ ] Estrutura MVC bÃ¡sica</li></p><p><h4>Recomendado:</h4>
<li>[ ] Sistema de logs</li>
<li>[ ] Cache de consultas</li>
<li>[ ] CompressÃ£o de assets</li>
<li>[ ] ProteÃ§Ã£o CSRF</li>
<li>[ ] Rate limiting para APIs</li>
<li>[ ] Backup automÃ¡tico</li></p><p><h4>AvanÃ§ado:</h4>
<li>[ ] PWA com Service Workers</li>
<li>[ ] Sistema de notificaÃ§Ãµes</li>
<li>[ ] IntegraÃ§Ã£o com APIs de pagamento</li>
<li>[ ] Dashboard administrativo</li>
<li>[ ] Sistema de relatÃ³rios</li></p><p>---</p><h2>ConclusÃ£o</h2><p>A estrutura do KlubeCash demonstra um sistema robusto e escalÃ¡vel que pode servir como base para diversos tipos de projetos web. Os padrÃµes adotados garantem:</p><p><li><strong>Maintibilidade</strong>: CÃ³digo organizado e bem estruturado</li>
<li><strong>SeguranÃ§a</strong>: PrÃ¡ticas de seguranÃ§a em todas as camadas</li>
<li><strong>Escalabilidade</strong>: Arquitetura que suporta crescimento</li>
<li><strong>ReutilizaÃ§Ã£o</strong>: Componentes modulares e reutilizÃ¡veis</li>
<li><strong>Performance</strong>: OtimizaÃ§Ãµes de cache e consultas</li></ul></p><p>Para implementar em outros projetos, recomenda-se adaptar os componentes conforme a necessidade especÃ­fica, mantendo sempre os princÃ­pios de seguranÃ§a e boas prÃ¡ticas apresentados nesta documentaÃ§Ã£o.</p><p>---</p><p><strong>Desenvolvido por</strong>: Equipe KlubeCash  
<strong>VersÃ£o</strong>: 2.1.0  
<strong>Data</strong>: 2025  
<strong>LicenÃ§a</strong>: ProprietÃ¡ria</p>
</body>
</html>